{
  "node": {
    "id": "app_envoy",
    "cluster": "app_envoy_cluster"
  },
  "admin": {
    "access_log_path": "/tmp/admin_access.log",
    "address": {
      "socket_address": {
        "address": "0.0.0.0",
        "port_value": 9901
      }
    }
  },
  "tracing": {
    "http": {
      "name": "envoy.dynamic.ot",
      "typed_config": {
        "@type": "type.googleapis.com/envoy.config.trace.v2.DynamicOtConfig",
        "library": "/data/services/libs/lib64/libjaegertracing.so",
        "config": {
          "service_name": "app-envoy",
          "sampler": {
            "type": "const",
            "param":1
          },
          "reporter":{
            "localAgentHostPort": "127.0.0.1:6831"
          },
          "headers": {
            "jaegerDebugHeader": "jaeger-debug-id",
            "jaegerBaggageHeader": "jaeger-baggage",
            "traceBaggageHeaderPrefix": "uberctx-"
          },
          "baggage_restrictions": {
            "denyBaggageOnInitializationFailure":false,
            "hostPort":""
          }
        }
      }
    }
  },
  "dynamic_resources": {
    "lds_config": {
      "ads": {}
    },
    "cds_config": {
      "ads": {}
    },
    "ads_config": {
      "api_type": "GRPC",
      "grpc_services": [
      {
        "envoy_grpc": {
          "cluster_name": "ads_cluster"
        }
      }
      ]
    }
  },
  "static_resources": {
    "listeners": [
    {
      "name": "ingress_listener",
      "address": {
        "socket_address": {
          "address": "0.0.0.0",
          "port_value": 15000
        }
      },
      "filter_chains": [
      {
        "filters": [
        {
          "name": "envoy.http_connection_manager",
          "typed_config": {
            "@type": "type.googleapis.com/envoy.config.filter.network.http_connection_manager.v2.HttpConnectionManager",
            "route_config": {
              "name": "local_route",
              "virtual_hosts": [
              {
                "name": "local_service",
                "routes": [
                {
                  "route": {
                    "cluster": "local_app"
                  },
                  "match": {
                    "grpc": {},
                    "prefix": "/"
                  }
                }
                ],
                "domains": [
                  "*"
                ]
              }
              ]
            },
            "codec_type": "AUTO",
            "http_filters": [
            {
              "name": "envoy.router"
            }
            ],
            "stat_prefix": "ingress_http",
            "tracing": {
              "operation_name": "INGRESS",
              "request_headers_for_tags": [
                "suid",
                "uid",
                "UUID"
              ]
            },
            "use_remote_address": true,
            "add_user_agent": true
          }
        }
        ]
      }
      ]
    },
    {
      "name": "egress_listener",
      "address": {
        "socket_address": {
          "address": "0.0.0.0",
          "port_value": 16000
        }
      },
      "filter_chains": [
      {
        "filters": [
        {
          "name": "envoy.http_connection_manager",
          "typed_config": {
            "@type": "type.googleapis.com/envoy.config.filter.network.http_connection_manager.v2.HttpConnectionManager",
            "http_filters": [
            {
              "name": "envoy.router"
            }
            ],
            "rds": {
              "config_source": {
                "ads": {}
              },
              "route_config_name": "ads_route"
            },
            "stat_prefix": "egress_http",
            "codec_type": "AUTO",
            "tracing": {
              "operation_name": "EGRESS",
              "request_headers_for_tags": [
                "suid",
                "uid",
                "UUID"
              ]
            },
            "generate_request_id": true,
            "use_remote_address": true,
            "add_user_agent": true
          }
        }
        ]
      }
      ]
    }
    ],
    "clusters": [
    {
      "name": "ads_cluster",
      "type": "STRICT_DNS",
      "connect_timeout": "0.250s",
      "http2_protocol_options": {},
      "load_assignment": {
        "cluster_name": "ads_cluster",
        "endpoints": [
        {
          "lb_endpoints": [
          {
            "endpoint": {
              "address": {
                "socket_address": {
                  "address": "xds.100.com",
                  "port_value": 5678
                }
              }
            }
          }
          ]
        }
        ]
      }
    },
    {
      "name": "local_app",
      "type": "STATIC",
      "connect_timeout": "0.250s",
      "http2_protocol_options": {},
      "circuit_breakers": {
        "thresholds": [
        {
          "max_connections": 100000,
          "max_pending_requests": 100000,
          "max_requests": 100000
        }
        ]
      },
      "load_assignment": {
        "cluster_name": "local_app",
        "endpoints": [
        {
          "lb_endpoints": [
          {
            "endpoint": {
              "address": {
                "socket_address": {
                  "address": "127.0.0.1",
                  "port_value": 15100
                }
              }
            }
          }
          ]
        }
        ]
      }
    }
    ]
  }
}
